<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="apple-touch-icon" sizes="57x57" href="/static/img/favicon/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/static/img/favicon/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/static/img/favicon/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/static/img/favicon/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/static/img/favicon/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/static/img/favicon/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/static/img/favicon/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/static/img/favicon/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/static/img/favicon/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192" href="/static/img/favicon/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/static/img/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="/static/img/favicon/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/static/img/favicon/favicon-16x16.png">
    <link rel="manifest" href="/manifest.json">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/ms-icon-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="google-signin-client_id"
          content="764760025104-is3262o216isl5tbfj4aakcel2tirl7n.apps.googleusercontent.com">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.7.1/css/bulma.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script defer src="https://use.fontawesome.com/releases/v5.1.0/js/all.js"></script>
    <script src="https://apis.google.com/js/platform.js" async defer></script>
    <script src="https://apis.google.com/js/client:platform.js" async defer></script>
    <title>PreMatch Discord Integration</title>
</head>
<body class="no-padding is-fullheight">
<div class="columns is-fullheight" id="container">
    <div class="column side has-text-centered is-fullheight" id="discord-side">
        <div class="columns is-narrow"
             style="flex-direction: column; min-height: 102vh; padding: 2vh 0; overflow: hidden;">
            <div class="column">
                <img id="logo" src="/static/img/discord.png">
            </div>
            <section class="column"
                     style="display: flex;flex-direction: column;align-items: center; justify-content: center; max-width: 100%; -webkit-flex: 1 0 auto;">
                <div style="flex: 1;">
                    {% for counter in range(3) %}
                        <div class="user-container other-user">
                            <div class="user-img">
                                <figure class="user-pfp">
                                    <img src="/static/img/discord%20pfp.png" height="75" width="75">
                                </figure>
                            </div>
                            <div class="user-info">
                                <p class="title has-text-light username">Name here</p>
                                <p class="subtitle has-text-grey id">#0000</p>
                            </div>
                        </div>
                    {% endfor %}
                    <div class="user-container is-user" id="user-box">
                        <div class="user-img">
                            <figure class="user-pfp">
                                <img src="{{ avatar_src }}" alt="{{ user_name }}" id="pfp" height="100" width="100">
                            </figure>
                        </div>
                        <div class="user-info">
                            <p class="title has-text-light username">{{ user_name }}</p>
                            <p class="subtitle has-text-grey id" id="user-id">#{{ user_discriminator }}</p>
                        </div>
                    </div>
                    {% for counter in range(3) %}
                        <div class="user-container other-user">
                            <div class="user-img">
                                <figure class="user-pfp">
                                    <img src="/static/img/discord%20pfp.png" height="75" width="75">
                                </figure>
                            </div>
                            <div class="user-info">
                                <p class="title has-text-light username">Name here</p>
                                <p class="subtitle has-text-grey id">#0000</p>
                            </div>
                        </div>
                    {% endfor %}
                </div>
            </section>
        </div>
    </div>
    <div class="column is-2 is-fullheight" id="blend">
        <h1 class="is-size-2 is-size-4-mobile" id="success">Success!</h1>
        <h2 class="is-size-2 is-size-4-mobile" id="now-try">Now try $$myday.</h2>
    </div>
    <div class="column side has-text-centered is-fullheight" id="prematch-side">
        <div style="display: flex; justify-content: center; align-items: center; height: 100%;">
            <div style="flex: 1;">
                <img id="logo" src="/static/img/PreMatch%20Logo.png">
                <div>
                    <h1 class="title is-size-1 has-text-white is-size-3-mobile">
                        <span id="prematch-name">{{ name }}</span>
                    </h1>
                    <h2 class="subtitle is-size-3 is-size-5-mobile" style="color:#ddd">
                        <span id="prematch-handle">{{ handle }}</span>
                    </h2>
                </div>
            </div>
        </div>
    </div>
    <div id="chain"></div>
</div>
<style>
    #discord-side {
        background-color: #36393f;
        color: #dcddde;
        font-family: 'Whitney', sans-serif;
    }

    .user-pfp img {
        border-radius: 50%;
    }

    #prematch-side {
        background-color: #03A9F4;
        color: #fff;
    }

    #logo {
        height: 150px;
    }

    .side {
        width: calc((100vw - 200px) / 2);
    }

    .column {
        padding: 0 0;
        flex: 1;
    }

    #blend {
        background: linear-gradient(to right, #36393f, #03A9F4);
        width: 200px;
        align-content: center;
        color: white;
        display: flex;
        justify-content: center;
        font-family: Whitney, sans-serif;
    }

    #success {
        position: absolute;
        top: 80px;
    }

    #now-try {
        position: absolute;
        bottom: 80px;
    }

    .columns {
        min-height: 420px;
        margin-bottom: 0 !important;
    }

    #chain {
        background: url('/static/img/chains.png') repeat-x center;
        width: 600px;
        height: 61px;
        position: absolute;
    }

    .user-img, .user-info {
        flex: 1;
    }

    .user-img {
        max-width: 75px;
    }

    .user-info {
        padding-left: 10px;
    }

    .user-container {
        display: flex;
        border-radius: 5px;
        padding: 8px;
        text-align: left;
        align-items: center;
    }

    .username {
        font-size: 30px;
    }

    .id {
        font-size: 20px;
    }

    .user-container.is-user {
        background-color: rgba(79, 84, 92, .6);
    }

    .user-container.is-user .user-img {
        max-width: 100px;
    }

    .user-container.is-user .user-info {
        margin-right: 10px;
    }

    .user-container.is-user .username {
        font-size: 48px;
    }

    .user-container.is-user .id {
        font-size: 32px;
    }
</style>
<script type="text/javascript">
    let bgColors = ['#f04747', '#faa61a', '#7289da', '#747f8d', '#43b581'];
    let names = ["Anakin Skywalker", "Luke Skywalker", "Darth Vader", "Obi-Wan Kenobi", "Leia Organa", "R2-D2", "C-3PO", "Chewbacca", "Han Solo", "Darth Maul"];
    let otherIds = [];

    function getRandomInt(max) {
        return Math.floor(Math.random() * Math.floor(max));
    }

    Array.prototype.forEach.call(document.getElementsByClassName('other-user'), (userCont) => {
        let pic = userCont.getElementsByTagName('img')[0];
        pic.style.backgroundColor = bgColors[getRandomInt(bgColors.length)];
        let name = userCont.getElementsByClassName('username')[0];
        let namesId = getRandomInt(names.length)
        name.innerHTML = names[namesId];
        names.splice(namesId, 1);
        let userId = document.getElementById('user-id').innerHTML.substr(1);
        let id = '';
        while (true) {
            for (let i = 0; i < 4; i++) {
                id += getRandomInt(10);
            }

            if (id === userId || otherIds.includes(id)) {
                id = '';
                continue;
            }

            otherIds.push(id);
            break;
        }

        let idText = userCont.getElementsByClassName('id')[0];
        idText.innerHTML = "#" + id;
    });

    function manageChain() {
        let chain = $('#chain');
        let userBox = $('#user-box');
        let prematchName = $('#prematch-name');
        let offset = userBox.offset();

        let top = offset.top + userBox.innerHeight() / 4;
        let left = offset.left + userBox.innerWidth() + 10;

        let prematchLeft = prematchName.offset().left - 10;

        let width = prematchLeft - left;

        chain.css({
           'top': top,
           'left': left,
           'width': width
        });
    }

    manageChain();

    $(window).resize(() => manageChain());
</script>
</body>
</html>